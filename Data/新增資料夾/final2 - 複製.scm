(define Macro1
   (lambda ( )
    (insert:part "D:/GAPY/file/prism_sat_file2.SAT")
(view:profiles "xy")
(view:zoom-all)
(edit:select-all-objects)
(edit:remove-selection (entity 31))
(property:apply-material (entity 1) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 2) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 3) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 4) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 5) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 6) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 7) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 8) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 9) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 10) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 11) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 12) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 13) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 14) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 15) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 16) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 17) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 18) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 19) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 20) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 21) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 22) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 23) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 24) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 25) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 26) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 27) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 28) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 29) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 30) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 32) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 33) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 34) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 35) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 36) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 37) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 38) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 39) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 40) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 41) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 42) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 43) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 44) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 45) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 46) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 47) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 48) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 49) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 50) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 51) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 52) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 53) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 54) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 55) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 56) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 57) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 58) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 59) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 60) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 61) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 62) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 63) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 64) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 65) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 66) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 67) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 68) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 69) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 70) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 71) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 72) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 73) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 74) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 75) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 76) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 77) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 78) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 79) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 80) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 81) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 82) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 83) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 84) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 85) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 86) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 87) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 88) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 89) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 90) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 91) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 92) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 93) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 94) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 95) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 96) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 97) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 98) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 99) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 100) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 101) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 102) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 103) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 104) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 105) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 106) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 107) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 108) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 109) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 110) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 111) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 112) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 113) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 114) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 115) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 116) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 117) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 118) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 119) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 120) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 121) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 122) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 123) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 124) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 125) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 126) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 127) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 128) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 129) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 130) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 131) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 132) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 133) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 134) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 135) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 136) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 137) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 138) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 139) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 140) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 141) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 142) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 143) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 144) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 145) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 146) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 147) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 148) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 149) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 150) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 151) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 152) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 153) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 154) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 155) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 156) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 157) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 158) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 159) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 160) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 161) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 162) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 163) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 164) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 165) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 166) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 167) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 168) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 169) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 170) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 171) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 172) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 173) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 174) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 175) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 176) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 177) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 178) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 179) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 180) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 181) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 182) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 183) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 184) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 185) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 186) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 187) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 188) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 189) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 190) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 191) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 192) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 193) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 194) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 195) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 196) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 197) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 198) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 199) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 200) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 201) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 202) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 203) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 204) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 205) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 206) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 207) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 208) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 209) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 210) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 211) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 212) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 213) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 214) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 215) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 216) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 217) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 218) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 219) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 220) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 221) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 222) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 223) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 224) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 225) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 226) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 227) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 228) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 229) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 230) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 231) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 232) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 233) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 234) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 235) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 236) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 237) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 238) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 239) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 240) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 241) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 242) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 243) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 244) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 245) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 246) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 247) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 248) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 249) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 250) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 251) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 252) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 253) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 254) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 255) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 256) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 257) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 258) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 259) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 260) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 261) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 262) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 263) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 264) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 265) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 266) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 267) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 268) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 269) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 270) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 271) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 272) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 273) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 274) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 275) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 276) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 277) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 278) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 279) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 280) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 281) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 282) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 283) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 284) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 285) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 286) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 287) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 288) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 289) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 290) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 291) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 292) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 293) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 294) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 295) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 296) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 297) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 298) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 299) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 300) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 301) "SCHOTT" "FK54" (gvector 0 0 0))
(property:apply-material (entity 302) "SCHOTT" "FK54" (gvector 0 0 0))
(edit:clear-selection)
(edit:add-selection (tools:face-in-body 1 (entity 53)))
(edit:add-selection (tools:face-in-body 3 (entity 53)))
(property:apply-surface (tools:face-in-body 1 (entity 53)) (list "Perfect Absorber" "Default")
  (gvector 0 0 0) (gvector 0 0 0)
  (position 0 0 0) (gvector 0 0 0) #t)
(property:apply-surface (tools:face-in-body 3 (entity 53)) (list "Perfect Absorber" "Default")
  (gvector 0 0 0) (gvector 0 0 0)
  (position 0 0 0) (gvector 0 0 0) #t)
(edit:clear-selection)
(edit:add-selection (entity 31))
(edit:add-selection (tools:face-in-body 0 (entity 31)))
(property:apply-flux-surface-source (tools:face-in-body 0 (entity 31)) 100 1000 2 #f)
(analysis:candela-normal (gvector 0 -1 0))
(analysis:candela-up (gvector -1 0 0))
(analysis:candela-ray-type "missed")
(analysis:candela-symmetry "none")
(analysis:candela-distribution 1 #f 540 #t #f)
(analysis:candela-distribution-luminaire 180)
(analysis:candela-distribution-max #f 0)
(analysis:candela-distribution-min #f 0)
(analysis:candela-distribution-log-plot #t)
(analysis:candela-rect-distribution-angular-width 180)
(raytrace:source)     
     
     
     (define ang_ini 10)             ;;初始仰角
     (define end 85)                ;;最終仰角
     (define angle 10)               ;;間隔角度
     (define rays_ini 1000)         ;;初始光線數
     (define rays_end 1000)
     (define rays_times 2)          ;;光線數倍數
     (define ini (- ang_ini angle))
     (define rays (/ rays_ini rays_times))
     (define name "20200913-prism light trace data")                           
     (define no1 "1_")  
     (define no2 "2_")
     (define no3 "3_")
     (define no4 "4_")
     (define bmp ".bmp")         
     (define txt ".txt")                      
     (define s1 "-")                     
     (define PCD "PCD")   
     (define RCD "RCD")
     (do                                     ;; loop over "i" form      
       ((i (+ ini angle) (+ i angle)))       ;; 初始仰角 (0) to 最終仰角 by + num 度      
       ((> i end))                           ;; quit when i is 最終仰角             
       (define s2 (number->string i))     
       (entity:rotate (entity 31) 55 490 0 0 0 1 angle);;對z軸旋轉 num 度  
       (do                     
         ((i (* rays rays_times) (* i rays_times)))                       
         ((> i rays_end))    
         (define s8 (number->string i))                                       
         (define bmp (string-append name s1 no1 s2 bmp ))
         (define pcd (string-append name s1 no2 s2 PCD bmp ))
         (define rcd (string-append name s1 no3 s2 RCD bmp ))
         (define txt (string-append name s1 no4 s2 txt))
         (raytrace:source)                          
         (file:save-as bmp)    
         (analysis:candela-save-bmp "polar-distribution" pcd)    
         (analysis:candela-save-bmp "rectangular-distribution" rcd)                           
         (analysis:candela-save-txt "polar-distribution" txt 361)
         )      
       ;;(entity:rotate (entity 31) 55 390 0 0 0 1 angle)                   
       )
      (file:save-as "D:/GAPY/file/Untitled.OML")
      (file:close)
      (file:new)
     
))
(Macro1)